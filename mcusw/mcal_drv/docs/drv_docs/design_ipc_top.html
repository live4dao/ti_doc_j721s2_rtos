<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>MCUSW: Cdd IPC Design Document</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MCUSW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('design_ipc_top.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Cdd IPC Design Document </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="design_cdd_ipc_intro"></a>
Introduction</h1>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_intro_overview"></a>
Overview</h2>
<p>The figure below depicts the AUTOSAR layered architecture as 3 distinct layers, Application, Runtime Environment (RTE) and Basic Software (BSW). The BSW is further divided into 4 layers, Services, Electronic Control Unit Abstraction, MicroController Abstraction (MCAL) and Complex Drivers.</p>
<p>MCAL is the lowest abstraction layer of the Basic Software. It contains software modules that interact with the Microcontroller and its internal peripherals directly. Inter Processor Communication (IPC) driver is part of the Complex Device Driver (block, show above). Below shows the position of the CDD IPC driver in the AUTOSAR Architecture.</p>
<div class="image">
<img src="autosar_acrhitecture_cdd.png" alt="autosar_acrhitecture_cdd.png"/>
<div class="caption">
AUTOSAR Architecture – CDD IPC MCAL</div></div>
<ul>
<li>Module ID shall be 255</li>
<li>Vendor ID shall be 44</li>
<li>Instance ID shall be 0</li>
</ul>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_overview"></a>
Cdd IPC Overview</h2>
<p>CDD IPC primarily used for communication with other cores on the SoC. This implementation relies on mailbox and shared memory to establish communication channel.</p>
<p>Shared memory holds the messages that requires to be transported and mailbox is used to notify the remote core on availability of a message.</p>
<h3><a class="anchor" id="design_cdd_ipc_basic_arch"></a>
Basic Working Principle</h3>
<div class="image">
<img src="cdd_ipc_arch_01.png" alt="cdd_ipc_arch_01.png"/>
<div class="caption">
CDD IPC MCAL - Basic Working Principle</div></div>
<h4>Transmission &amp; Reception</h4>
<p>Transmission of message from 1 processor to another is performed by 4 step sequence. As depicted above</p>
<ul>
<li>Processor 1 has to send a message of 128 bytes to Processor 2</li>
</ul>
<ol type="1">
<li>Processor 1 copies the message to shared area, designated write area to this processor</li>
<li>Writes a pre-determined pattern to mailbox</li>
<li>Processor 2, receives an interrupt indicating presence of a message in Processor 1, designated write area.</li>
<li>Processor 2, read the data from shared area</li>
<li>Processor 2, processes the received message and has to reply back with different message</li>
<li>Processor 2 copies the message to shared area, designated write area to this processor</li>
<li>Writes a pre-determined pattern to mailbox</li>
<li>Processor 1, receives an interrupt indicating presence of a message in Processor 2, designated write area.</li>
<li>Processor 1, read the data from shared area</li>
<li>Processor 1, processes the received message</li>
</ol>
<ul>
<li><b> Note that dotted line indicates a READ-ONLY operation </b></li>
</ul>
<hr/>
<h4>Mailbox hardware</h4>
<p>Communication between the on-chip processors of TDAxx class of devices uses a queued (FIFO) mailbox-interrupt mechanism. The queued mailbox-interrupt mechanism allows the software to establish a communication channel between two processors through a set of registers and associated interrupt signals by sending and receiving messages. Mailbox could be envisioned as shared FIFO between cores and can generate an interrupt either on reception of a 32 bit word or on FIFO not being empty.</p>
<p>Below shows the block diagram of the Mailbox IP, FIFO (referred as FIFO ID, throughout this document) could be used to write and read messages. The depth of the FIFO depends on the SOC used and an interrupt could be generated either on reception of a 32 bit word or on FIFO not being empty. These interrupts could be routed to any of the cores (refer device specific TRM for restrictions, not all mailboxes interrupts could be routed to all cores)</p>
<div class="image">
<img src="cdd_ipc_arch_mailbox_01.png" alt="cdd_ipc_arch_mailbox_01.png"/>
<div class="caption">
Mailbox Block Diagram</div></div>
<div class="image">
<img src="cdd_ipc_arch_mailbox_02.png" alt="cdd_ipc_arch_mailbox_02.png"/>
<div class="caption">
Example of Communication between 2 cores</div></div>
<p>It's important to note that the Mailbox hardware shall not be reset, as there could be pending messages in the FIFO. Other entities (such as boot-loader, start up sequence would have reset the mailbox)</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_001  </td></tr>
<tr>
<td><em><b>Requirements</b></em> </td><td>MCAL-3707   </td></tr>
</table>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_rational"></a>
Rational for IPC as an CDD</h3>
<p>TDAxxx class of processors has multiple processing cores (such as DSP’s, ARM (A7, R5F), etc.…) and AUTOSAR stack is not hosted on all of these cores (i.e. heterogeneous system with one or more OS’s) and AUTOSAR doesn’t define standardized entity for inter-core communication in a heterogeneous multi-core systems. Hence a CDD is implemented to provide communication mechanism between cores via Mailbox (peripheral for inter-processors communication mechanism) and shared memory.</p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_references"></a>
References</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Sl No  </th><th class="markdownTableHeadNone">Specification  </th><th class="markdownTableHeadNone">Comment / Link   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">AUTOSAR 4.3.1  </td><td class="markdownTableBodyNone">CDD Design &amp; Integration Guideline <a href="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-3/AUTOSAR_EXP_CDDDesignAndIntegrationGuideline.pdf">Intranet Link</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">TDA4x TRM  </td><td class="markdownTableBodyNone">Technical Reference Manual, <a href="http://www.ti.com/product/TDA4VM/technicaldocuments">TDA4X</a> Mailbox module is detailed   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">BSW General Requirements / Coding guidelines  </td><td class="markdownTableBodyNone"><a href="https://confluence.itg.ti.com/display/MCAL/Coding+Guidelines">Intranet Link</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">Software Product Specification (SPS)  </td><td class="markdownTableBodyNone"><a href="https://confluence.itg.ti.com/display/MCAL/MCUSW+Software+Product+Specification">Intranet Link</a> Requirements are derived from <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">1</a> &amp; <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">2</a>   </td></tr>
</table>
<hr/>
 <h1><a class="anchor" id="design_cdd_ipc_req"></a>
Requirements</h1>
<p>The CDD IPC driver shall implement as per requirements detailed in <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">4</a>, <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">1</a> and <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">2</a>. It’s recommended to refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_references">1</a> for clarification.</p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_features_supported"></a>
Features Supported</h2>
<p>Below listed are some of the key features that are expected to be supported</p>
<ul>
<li>Ability to transport fixed messages across cores</li>
<li>Notify on reception of message from remote core</li>
<li>Received messages are retained within the driver until consumed by applications<ul>
<li>i.e. Messages will not be available in the new message notification ISR. Service API call required to receive the message</li>
<li>Number of messages that can be queued is configurable</li>
</ul>
</li>
<li>Configureable maximum message size</li>
<li>Ability to announce capability of core to all other cores</li>
<li>PRE COMPILE Variant is supported</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_002  </td></tr>
<tr>
<td><em><b>Requirements</b></em> </td><td>MCAL-964, MCAL-3717, MCAL3691, MCAL-3724, MCAL-3682, MCAL-3685, MCAL-3730, MCAL-3708, MCAL-920 MCAL-3703   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <div class="image">
<img src="caution.png" alt="caution.png"/>
</div>
   <h2><a class="anchor" id="design_cdd_ipc_features_not_supported"></a>
Features Not Supported</h2>
<ul>
<li>Non use of shared memory for message length &lt;= 32bits<ul>
<li>Always uses shared memory irrespective of the message length</li>
</ul>
</li>
<li>Configureability to use different mailbox, user id, FIFO ID &amp; cluster<ul>
<li>Mailbox, user id, FIFO ID and cluster instance is built into driver, that guranteens inter-interoperability with TI IPC drivers</li>
</ul>
</li>
<li>VARIANT-POST-BUILD and VARIANT-LINK-TIME Variants are not supported</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_003  </td></tr>
<tr>
<td><em><b>Non Requirements</b></em> </td><td>MCAL-3708, MCAL-3709, MCAL-3710   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_assumptions"></a>
Assumptions</h2>
<p>Below listed are assumed to valid for this design/implementation, exceptions and other deviations are listed for each explicitly. Care should be taken to ensure these assumptions are addressed.</p>
<ol type="1">
<li><b> This design assumes that TI IPC driver are used in the remote cores </b></li>
<li><b> The shared buffer shall be allocated in non-cached region and accessible to all cores participating in IPC </b></li>
<li>The functional clock to the Mailbox module is expected to be on before calling any CDD IPC service APIs</li>
<li>The CDD IPC driver as such doesn’t perform any PRCM programming to get the functional clock</li>
<li>Configurator : This design do not depend on the configurator used. Use of EB Configurator is recommended as other MCAL modules use the same.</li>
</ol>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_004  </td></tr>
<tr>
<td><em><b>Non Requirements</b></em> </td><td>MCAL-3699, MCAL-3675, MCAL-921   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_constraints"></a>
Constraints</h2>
<p>Some of the critical constraints of this design are listed below</p>
<ul>
<li>The communication channels are created statically, via the configurator<ul>
<li>i.e. Remote end points of the remote core will have to defined and CDD IPC configurations generated before compilation.</li>
</ul>
</li>
<li>Reserved END POINT, CDD IPC will reserve one of the end point which shall be be used to communicate control messages. Control endpoint would 53 Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_Cdd_IpcAnnounce">API</a>, <table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_005  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3677, MCAL-3678, MCAL-3679, MCAL-3680, MCAL-3681, MCAL-3682, MCAL-3685, MCAL-3686, MCAL-3760   </td></tr>
</table>
</li>
</ul>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="design_cdd_ipc_description"></a>
Design Description</h1>
<hr/>
<p> As detailed in <a class="el" href="design_ipc_top.html#design_cdd_ipc_overview">Overview</a>, IPC relies on shared memory &amp; mailbox to transmit and receive messages. Section below highlight some of the key concepts.</p>
<h2>Shared Memory</h2>
<p>As discussed in <a class="el" href="design_ipc_top.html#design_cdd_ipc_basic_arch">Basic Principle</a>, shared memory is required for IPC. This shared memory region shall be referred as <b>VirtIo</b></p>
<h2><a class="anchor" id="design_cdd_ipc_proc_id"></a>
Processor Identifiers</h2>
<p>In order to be able to communicate with multiple cores, each cores requires to be identified uniquely. Refereed as <b>procId</b> in the rest of this document.</p>
<p>The configurator shall allow integrators to select set of cores, with which communication is desired.</p>
<h2><a class="anchor" id="design_cdd_ipc_ep_id"></a>
End Point</h2>
<p>To allow multiple logical channels for communications an end-point shall be used. The end-point shall be an unsigned integer configurable through the configurator, with the exception of reserved end point. Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_constraints">Constraint End Point</a> for details</p>
<div class="image">
<img src="cdd_ipc_arch_ep.png" alt="cdd_ipc_arch_ep.png"/>
<div class="caption">
Need of End-Point in communication</div></div>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_006  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3672, MCAL-3673, MCAL-3674, MCAL-3675, MCAL-3676, MCAL-3668, MCAL-3669, MCAL-3670, MCAL-3671, MCAL3679, MCAL-3680, MCAL-3681   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_rpmsg_id"></a>
Message Buffer</h2>
<p>Referring the diagram below, Processor 1 reads from Processor 2 designated write area and vice versa. To prevent loss of messages (in cases where the receiving processor was slower/loaded with other high priority tasks) the message is copied into local queue. When service API to receive is invoked, the received message from the queue is copied into user provided buffer. Please note that, these copies are CPU based copies.</p>
<div class="image">
<img src="cdd_ipc_arch_rpmsgQ.png" alt="cdd_ipc_arch_rpmsgQ.png"/>
<div class="caption">
Need for Queue to store received messages</div></div>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_007  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3682, MCAL-3674, MCAL-3755   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_virtio_obj_id"></a>
Queue in shared memory</h2>
<p>It could be possible that one processor (producer) might generate faster IPC messages than another processor (consumer). To avoid messages being over-written/lost an shared queue shall be implemented in the shared buffer, as depicted in the diagram below</p>
<div class="image">
<img src="cdd_ipc_arch_sharedQ.png" alt="cdd_ipc_arch_sharedQ.png"/>
<div class="caption">
Shared Queue</div></div>
<p>Some of the key points to note, considering the above example</p><ul>
<li>The queue implemented in Processor 1 designated shared area<ol type="1">
<li>The queue shall be circular queue</li>
<li>The writer (Processor 1, in this e.g.) shall write and advance write-pointer only</li>
<li>The reader (Processor 2, in this e.g.) shall read and advance read-pointer only</li>
<li>The actual message shall be stored in the designated shared area and queue element shall contain a pointer to the message.</li>
</ol>
</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_008  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3673, MCAL-3674   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_multi_ep_id"></a>
Multiple End Point / Communication Channels</h2>
<p>IPC CDD shall provide ability to create multiple end-point pairs. As depicted in the diagram below, applications could define multiple end-point pairs to realize multiple communication channels</p>
<div class="image">
<img src="cdd_ipc_arch_multi_ep.png" alt="cdd_ipc_arch_multi_ep.png"/>
<div class="caption">
Multiple End Points</div></div>
<p>Some of the key points to note, considering the above example</p><ul>
<li>From the perspective of <em> Processor 1 </em><ol type="1">
<li>Local End Points (Local EP X, Y, M &amp; N) define end-points on Processor 1</li>
<li>Remote End Points (Remote EP X', Y', M' &amp; N') define end-points on Processor 2</li>
<li>End-point pairs (X and X', Y and Y', M and M' &amp; N and N') define 4 distinct communication channels</li>
<li>End-point pairs X and X', Y and Y' are used to transmission of messages from Processor 1 to Processor 2</li>
<li>End-point pairs M and M', N and N' are used to reception of messages from Processor 2 to Processor 1</li>
<li>Note that X &amp; X' could be same and shall be honored.</li>
</ol>
</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_009  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3685   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="design_cdd_ipc_ctrl_ep_id"></a>
Control End Point</h2>
<p>IPC CDD shall create a <b>control end point</b> primarily used for communication of control messages. This shall be created by default, provided <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_cfg_gen">CddIpcAnnounceApi</a> is ON</p>
<div class="image">
<img src="demo_cdd_ipc_ctrl_ep.png" alt="demo_cdd_ipc_ctrl_ep.png"/>
<div class="caption">
Control End Points</div></div>
<p>Some of the key points to note, considering the above example</p><ul>
<li>From the perspective of <em> Processor 1 </em><ol type="1">
<li>Control end point shall be used to announce availability of a remote end point to processes messages</li>
<li>Shall allow transportation of n bytes of data</li>
<li>Shall not be bound to user defined end point</li>
<li>Shall rely on <a class="el" href="design_ipc_top.html#design_cdd_ipc_constraints">Reserved END POINT</a></li>
</ol>
</li>
</ul>
<p>A Typical sequene would be, assuming Processor 1 start first followed by Processor 2</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Time  </th><th class="markdownTableHeadNone">Processor 1  </th><th class="markdownTableHeadNone">Processor 2   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">T1  </td><td class="markdownTableBodyNone">Annouce Availability of end points - Step 1  </td><td class="markdownTableBodyNone">Not Yet Started   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">T2  </td><td class="markdownTableBodyNone">Wait for control message - Step 2  </td><td class="markdownTableBodyNone">Not Yet Started   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">T3  </td><td class="markdownTableBodyNone">Waiting  </td><td class="markdownTableBodyNone">Annouce Availability of end points - Step ~1   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">T4  </td><td class="markdownTableBodyNone">Validate Control message  </td><td class="markdownTableBodyNone">Wait for control message - Step ~2   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">T5  </td><td class="markdownTableBodyNone">Trasmit/Receive message  </td><td class="markdownTableBodyNone">Validate control message   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">T6  </td><td class="markdownTableBodyNone">Trasmit/Receive message  </td><td class="markdownTableBodyNone">Trasmit/Receive message   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_037  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-4068, MCAL-4069   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_dynamic"></a>
Dynamic Behavior</h2>
<h3><a class="anchor" id="design_cdd_ipc_desc_dynamic_state"></a>
States</h3>
<p>CDD IPC shall maintain two distinct states <b>Initialized</b> &amp; <b> Un Initialized </b></p>
<p><b>Initialized State &lt;====&gt; Un Initialized State </b></p>
<ul>
<li><b>Initialized State</b><ul>
<li>All service API's shall be honored</li>
<li>All configured communication channels created</li>
<li>Shall be able to receive messages from configured remote core on configured end-point.</li>
</ul>
</li>
<li><b>Un Initialized State</b><ul>
<li>All service API's shall NOT be honored, Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api_gver">API</a></li>
<li>Any service API invoked shall return CDD_IPC_E_INIT_FAILED</li>
</ul>
</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_010  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3706, MCAL-3715, MCAL-3756   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_deter_dir"></a>
Directory Structure</h2>
<p>The directory structure is as depicted in figures below, the source files can be categorized under “Driver Implementation” and “Configuration”</p>
<p><b>Driver Implemented by </b></p><ul>
<li><a class="el" href="Cdd__Ipc_8h.html" title="This file contains interface for InterProcessorCommunication (Ipc) as a complex device driver.">Cdd_Ipc.h</a> and <a class="el" href="Cdd__IpcIrq_8h.html" title="This file contains ISR function declaration for CDD IPC Driver.">Cdd_IpcIrq.h</a>: Shall implement the interface provided by the driver</li>
<li>Cdd_Ipc.c, Cdd_IpcIrq.c : Shall implement the driver functionality</li>
<li><b> Cdd_IpcCbk.h </b> : Shall define function prototype that shall be implemented by the applications and invoked by the driver on reception of new message.</li>
</ul>
<div class="image">
<img src="cdd_ipc_dir_src.png" alt="cdd_ipc_dir_src.png"/>
<div class="caption">
IPC CDD Directory Structure</div></div>
<p><b>Configuration</b></p><ul>
<li>Standard EB configuration structure</li>
</ul>
<div class="image">
<img src="cdd_ipc_dir_config.png" alt="cdd_ipc_dir_config.png"/>
<div class="caption">
Configurator Plugin Directory Structure</div></div>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_cfg"></a>
Configurator</h2>
<p>TI specific parameters are detailed in following sections and Standard AUTOSAR parameters are not detailed.</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_011  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-921, MCAL-964   </td></tr>
</table>
<p>Following lists this design’s specific configurable parameters</p>
<h3><a class="anchor" id="design_cdd_ipc_desc_cfg_gen"></a>
CDD IPC General Configuration parameters</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Usage comment   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CddIpcOSCounterId  </td><td class="markdownTableBodyNone">This shall allow integrators to specify the OS counter instance to be used in OS API GetCounterValue () The driver shall implement timed-wait for all waits (e.g. waiting for reset to complete). This timed wait shall use OS API GetCounterValue ()   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CddIpcDeviceVariant  </td><td class="markdownTableBodyNone">This shall allow integrators to select the device variant for which integration is being performed. This parameter shall be used by driver to impose device specific constraints. The user guide shall detail the device specific constraints   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CddDevErrorDetect  </td><td class="markdownTableBodyNone">This parameter turns on ERROR detection and shall be used during development, disabled for production builds   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>NewMsgNtfyFunc </b>  </td><td class="markdownTableBodyNone">Specify the integrator defined function that would invoked on reception of new message   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CddVersionInfoApi  </td><td class="markdownTableBodyNone">Enable / Disable Get Version Info service API   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CddDeinitApi  </td><td class="markdownTableBodyNone">Enable / Disable De Initialization of IPC CDD service API   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CddIpcAnnounceApi  </td><td class="markdownTableBodyNone">Enable / Disable Announcement (broadcast) of processors capabilities to other cores. This service API would be mandatory when the remote core hosts Linux   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CddRegisterReadBackApi  </td><td class="markdownTableBodyNone">Enable / Disable service API to Read back of critical registers   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CddIrqType  </td><td class="markdownTableBodyNone">Specify category of ISR, Only CAT 2 is supported   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_012  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3694, MCAL-980, MCAL-3693, MCAL-3691, MCAL-3690, MCAL-3688, MCAL-3689, MCAL-3687, MCAL-3692, MCAL-3696   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_desc_shared_mem"></a>
CDD IPC Shared Memory Configuration parameters</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Usage comment   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VertIoRingAddr  </td><td class="markdownTableBodyNone">Specify the physical address of the shared memory. [Constraints] Please refer (<a class="el" href="design_ipc_top.html#design_cdd_ipc_constraints">Constraints</a>) &amp; (<a class="el" href="design_ipc_top.html#design_cdd_ipc_overview">Cdd IPC Overview</a>)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">VertIoRingSize  </td><td class="markdownTableBodyNone">Please retain the recommended configurations. When changing, ensure the size is same across all cores that uses IPC.   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VertIoObjSize  </td><td class="markdownTableBodyNone">Non shared memory, used for book-keeping of VRING. Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_rpmsg_id">LocalQ</a>. Note that memory shall be allocated in the generate configuration and alignment to 128 byte boundary shall be ensured.   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_013  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3674, MCAL-3675, MCAL-3676   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_desc_ownProc"></a>
CDD IPC Processor Identifier</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Usage comment   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">OwnProcID  </td><td class="markdownTableBodyNone">Select the current processor on which the MCAL/AUTOSAR is hosted   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_014  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3668, MCAL-3669, MCAL-980   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_desc_remote_proc"></a>
CDD IPC Processor Identifier Remote</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Usage comment   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ProcID  </td><td class="markdownTableBodyNone">Select the list of remote processor ID, which with IPC is desired. Please note that all selected remote processors shall host TI IPC   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_015  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3671   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_desc_com_chs"></a>
CDD IPC Communication Channels</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Usage comment   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CommId  </td><td class="markdownTableBodyNone">Specify an unique integer that uniquely identifies the communication channel. This ID shall be used in service API's to transmit/receive/notify arrival on new message. Configurator shall support symbolic names for the communication ID's   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LocalEp  </td><td class="markdownTableBodyNone">Local End Point, specify an unique integer that uniquely identifies the communication channel end-point on a given processor. The reserved end-point shall not be accepted by the configurator   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RemoteEp  </td><td class="markdownTableBodyNone">Remote End Point, specify an unique integer that uniquely identifies the communication channel end-point on a associated remote processor. The reserved end-point shall not be accepted by the configurator   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RemoteProcID  </td><td class="markdownTableBodyNone">Remote processor, shall be one of the processor listed in (<a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_remote_proc">CDD IPC Processor Identifier Remote</a>)   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MaxNumMsgQueue  </td><td class="markdownTableBodyNone">Specify the maximum number of messages that can queued (before received by call to receive service API) (<a class="el" href="design_ipc_top.html#design_cdd_ipc_rpmsg_id">Message Buffer</a>)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MaxMsgSize  </td><td class="markdownTableBodyNone">Specify the maximum size of all possible messages that could be received. (before received by call to receive service API) (<a class="el" href="design_ipc_top.html#design_cdd_ipc_rpmsg_id">Message Buffer</a>)   </td></tr>
</table>
<div class="image">
<img src="caution.png" alt="caution.png"/>
</div>
   <ul>
<li>The driver shall reserves space to implement a queue of elements and the size shall be <b>MaxNumMsgQueue * MaxMsgSize bytes </b>.</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_016  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3677, MCAL-3678, MCAL-3679, MCAL-3680, MCAL-3681, MCAL-3682, MCAL-3685, MCAL-3686, MCAL-3755, MCAL-3686   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_desc_cfg_variant"></a>
Variant Support</h3>
<p>The driver shall support VARIANT-PRE-COMPILE only</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_017  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3703   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_cfg_dependency"></a>
Dependency on other modules</h2>
<p>CDD IPC driver shall depend on these modules to realize the required functionality.</p><ul>
<li>Standard BSW / AUTOSAR modules<ul>
<li>Det : To report development errors. Should be able to turn OFF (especially for production build)</li>
<li>Dem : To report run time error (e.g. report critical error / warning, when Det is turned off: STD_OFF)</li>
<li>SchM : For exclusive access (in interrupt context and thread/task context)</li>
</ul>
</li>
<li>PDK<ul>
<li>CSL / LLD : Low level API's configure the peripheral and manipulate queues, shared memory &amp; Core ID's</li>
</ul>
</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_018  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3699, MCAL-3693, MCAL-3698, MCAL-3697, MCAL-3700   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_error"></a>
Error Classification</h2>
<p>Errors are classified in two categories, development error and runtime / production error.</p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_desc_error_dev"></a>
Development Errors</h3>
<table class="doxtable">
<tr>
<td><em><b> Type of Error </b></em> </td><td><em><b> Related Error code </b></em> </td><td><em><b> Value (Hex)</b></em> </td><td><em><b> Refer Req </b></em>  </td></tr>
<tr>
<td>API error return code: Init function failed  </td><td>CDD_IPC_E_INIT_FAILED  </td><td>0x01  </td><td>MCAL-2516   </td></tr>
<tr>
<td>Service API is called without module initialization  </td><td>CDD_IPC_E_UNINIT  </td><td>0x02  </td><td>MCAL-3756   </td></tr>
<tr>
<td>API parameter checking: invalid value  </td><td>CDD_IPC_E_PARAM_POINTER  </td><td>0x03  </td><td>MCAL-2518   </td></tr>
<tr>
<td>API service for initialization is called when already initialized  </td><td>CDD_IPC_E_ALREADY_INITIALIZED  </td><td>0x04  </td><td>MCAL-2515   </td></tr>
<tr>
<td>Error code indicating wrong configuration  </td><td>CDD_IPC_E_INVALID_CONFIG  </td><td>0x05  </td><td>MCAL-2517   </td></tr>
<tr>
<td>Error code indicating sending of an message failed  </td><td>CDD_IPC_E_SEND  </td><td>0x06  </td><td>MCAL-2517   </td></tr>
<tr>
<td>Error code indicating sending of an message failed  </td><td>CDD_IPC_E_RECEIVE_RETRY  </td><td>0x07  </td><td>MCAL-2517   </td></tr>
<tr>
<td>Error code indicating feature is not supported  </td><td>CDD_IPC_E_NOT_SUPPORTED  </td><td>0x08  </td><td>MCAL-2517   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_019  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3720, MCAL-3721, MCAL-3722, MCAL-3723, MCAL-3727, MCAL-3729, MCAL-3734, MCAL-3740, MCAL-3756   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_desc_error_dev_detect"></a>
Error Detection</h3>
<p>The detection of development errors is configurable (ON / OFF) at pre-compile time. The switch CddDevErrorDetect shall activate or deactivate the detection of all development errors.</p>
<h3><a class="anchor" id="design_cdd_ipc_desc_error_dev_notify"></a>
Error notification (DET)</h3>
<p>All detected development errors are reported to Det_ReportError service of the Development Error Tracer (DET).</p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_desc_error_runtime"></a>
Runtime Errors</h3>
<p>The following runtime/production errors shall be detectable by CDD IPC driver</p>
<table class="doxtable">
<tr>
<td><em><b> Type of Error </b></em> </td><td><em><b> Related Error code </b></em> </td><td><em><b> Value (Hex)</b></em>  </td></tr>
<tr>
<td>This error shall be reported when Mailbox is not functional  </td><td>CDD_IPC_E_HARDWARE_ERROR  </td><td>Defined By Integrator   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_desc_error_dev_notify_dem"></a>
Error notification (DEM)</h3>
<p>All detected run time errors shall be reported to Dem_ReportErrorStatus () service of the Diagnostic Event Manager (DEM).</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_020  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3698, MCAL-3693,   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_desc_res_behave"></a>
Resource Behavior</h2>
<ul>
<li><b> Code Size </b>: Implementation of this driver shall not exceed 5 kilo lines of code and 1 KB of data section.</li>
<li><b> Stack Size </b>: Worst case stack utilization shall not exceed 2 kilo bytes.</li>
</ul>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_021  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3747, MCAL-3748, MCAL-929   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h1><a class="anchor" id="design_cdd_ipc_low_level"></a>
Low Level Definitions</h1>
<hr/>
<p> This section describes the API supported by the MCAL driver and the requirements covered by each of the API.</p>
<h2><a class="anchor" id="design_cdd_ipc_low_level_dtypes"></a>
MACROS, Data Types &amp; Structures</h2>
<p>The sections below lists some of key data structures that shall be implemented and used in driver implementation</p>
<h3><a class="anchor" id="design_cdd_ipc_max_numchannels"></a>
Maximum number of channels</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Identifier  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">CDD_IPC_CORE_ID_MAX  </td><td class="markdownTableBodyNone">Defines the maximum number of remote cores supported by this implementation. This macro shall be used to allocate memory (statically) in the driver implementation.   </td></tr>
</table>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcMpType"></a>
Cdd_IpcMpType</h3>
<p>Used to specify the core identifiers, these values shall be generated by the configurator and not explicitly by the user of this module.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Identifier  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">ownProcID  </td><td class="markdownTableBodyNone">Defines processor ID on which MCAL/AUTOSAR is being hosted   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">numProcs  </td><td class="markdownTableBodyNone">Number of remote processor which with IPC is desired   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">remoteProcID  </td><td class="markdownTableBodyNone">Array of uin32, that specifies the remote processor identifier   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_022  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3668, MCAL-3669, MCAL-3670, MCAL-3671   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcVertIoType"></a>
Cdd_IpcVertIoType</h3>
<p>Defines Shared Memories for VRING and VRING OBJECT, these values shall be generated by the configurator and not explicitly by the user of this module. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Identifier  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">void *  </td><td class="markdownTableBodyNone">vertIoRingAddr  </td><td class="markdownTableBodyNone">Defines address that shall be shared between cores, also refer (<a class="el" href="design_ipc_top.html#design_cdd_ipc_assumptions">Assumptions</a>)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">vertIoRingSize  </td><td class="markdownTableBodyNone">Size in number of bytes   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_023  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3672, MCAL-3673   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcChannelType"></a>
Cdd_IpcChannelType</h3>
<p>Defines logical communication channel between cores, these values shall be generated by the configurator and not explicitly by the user of this module. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Identifier  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">id  </td><td class="markdownTableBodyNone">Unique identifiers for a channel   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">localEp  </td><td class="markdownTableBodyNone">Local End Point identifier, on which MCAL/AUTOSAR is hosted   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">remoteProcId  </td><td class="markdownTableBodyNone">Remote Processor Identifier   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">numMsgQueued  </td><td class="markdownTableBodyNone">Maximum depth of the queue, that holds received messages   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">maxMsgSize  </td><td class="markdownTableBodyNone">Maximum size of the message that could be received   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_024  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3677, MCAL-3678, MCAL-3679, MCAL-3680, MCAL-3681, MCAL-3682, MCAL-3755   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcConfigType"></a>
Cdd_IpcConfigType</h3>
<p>CDD IPC Configuration type, these values shall be generated by the configurator and not explicitly by the user of this module. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Identifier  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="structCdd__IpcMpType.html" title="Defines processor identifiers Core on which MCAL/AUTOSAR is hosted and other cores with which IPC is ...">Cdd_IpcMpType</a>  </td><td class="markdownTableBodyNone">coreIds  </td><td class="markdownTableBodyNone">Used to specify the core identifiers refer (<a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcMpType">Cdd_IpcMpType</a>)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="structCdd__IpcVertIoType.html" title="Defines Shared Memories for VRING and VRING OBJECT VRING is the shared memory between cores and VRING...">Cdd_IpcVertIoType</a>  </td><td class="markdownTableBodyNone">vertIoCfg  </td><td class="markdownTableBodyNone">VertIO configurations refer (<a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcVertIoType">Cdd_IpcVertIoType</a>)   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">channelCount  </td><td class="markdownTableBodyNone">Number of communication channels configured by the integrator   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="structCdd__IpcChannelType.html" title="Defines logical communication channel between cores.">Cdd_IpcChannelType</a> *  </td><td class="markdownTableBodyNone">pChCfg  </td><td class="markdownTableBodyNone">Pointer to constant, refer (<a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">Cdd_IpcChannelType</a>)   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_025  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3702, MCAL-3705   </td></tr>
</table>
<h3><a class="anchor" id="design_cdd_ipc_low_level_readback_type"></a>
Cdd_IpcRegRbValues</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Range  </th><th class="markdownTableHeadNone">Comments   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">numRegisters  </td><td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">0 to 0xFFFFFFFF  </td><td class="markdownTableBodyNone">Will specify number of registers values provided   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">regValues  </td><td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">0 to 0xFFFFFFFF  </td><td class="markdownTableBodyNone">Values of critical registers that's read and provided   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">reserved  </td><td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">Reserved for future use   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_low_level_api"></a>
API's</h2>
<p>Sections below defines the expected API's to part of this implementation</p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcNewMessageNotify"></a>
Cdd_IpcNewMessageNotify</h3>
<p>Is a function implemented by the application, with prototype as <b> void Cdd_IpcNewMessageNotify ( uint32 commId ) </b>, where commId is the value specified by integrator while creating the communication channel <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">id</a></p>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Function Name</b></em> </td><td>Cdd_IpcNewMessageNotify </td><td>Is a symbolic name, integrators can specify desired name   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>void <a class="el" href="group__MCAL__IPC__CFG.html#ga33e3be4d4af1eec308b9a24b27ec7999" title="New Message notification function.">Cdd_IpcNewMessageNotify( uint32 commId )</a>  </td><td>Shall be implemented by the MCAL consumer   </td></tr>
<tr>
<td><em><b> Called Context</b></em> </td><td>Interrupt </td><td>This function would be invoked by driver in interrupt context. Also refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api_isr">Flow Chart</a> for implementation of the ISR.   </td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>uint32 commId  </td><td>commId is the value specified by integrator while creating the communication channel <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">id</a>  </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>None  </td><td>NA   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_026  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3691, MCAL-3701   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_Cdd_IpcCtrlNewMessageNotify"></a>
Cdd_IpcNewCtrlMessageNotify</h3>
<p>Is a function implemented by the application, with prototype as <b> void Cdd_IpcNewCtrlMessageNotify ( uint32 remoteProcId ) </b>, where remoteProcId is remote processor ID <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcMpType">Specified During Initialization</a></p>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Function Name</b></em> </td><td>Cdd_IpcNewCtrlMessageNotify </td><td>Is a symbolic name, integrators can specify desired name   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>void <a class="el" href="group__MCAL__IPC__CFG.html#gac48945dc8426adcbad4d8e6958b2e063" title="New Control Message notification function.">Cdd_IpcNewCtrlMessageNotify( uint32 remoteProcId )</a>  </td><td>Shall be implemented by the MCAL consumer   </td></tr>
<tr>
<td><em><b> Called Context</b></em> </td><td>Interrupt </td><td>This function would be invoked by driver in interrupt context. Also refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_ctrl_ep_id">Control End Point</a>   </td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>uint32 remoteProcId  </td><td>One of the Remote processor ID <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcMpType">Specified During Initialization</a>  </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>None  </td><td>NA   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_038  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-4067, MCAL-4066   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_low_level_api_init"></a>
Cdd_IpcInit</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcInit </td><td>First API to be invoked to initialize the module   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType <a class="el" href="group__MCAL__IPC__API.html#ga8e364a6e4653429d9fea902eb97edfaa" title="Service for CDD Initialization.">Cdd_IpcInit(void)</a>  </td><td>Service for CDD Initialization  </td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x02 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>none </td><td>NA  </td></tr>
<tr>
<td><em><b>Parameters out</b></em> </td><td>none </td><td>NA   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK or CDD_IPC_E_INIT_FAILED in case of initialization failure id, or CDD_IPC_E_ALREADY_INITIALIZED in case of reinitialization  </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_027  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3706, MCAL-3707, MCAL-3708, MCAL-3709, MCAL-3710, MCAL-3712, MCAL-3713, MCAL-3714, MCAL-3715, MCAL-3716   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_Cdd_IpcDeinit"></a>
Cdd_IpcDeinit</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcDeinit </td><td>Last API to be invoked to de initialize the module, can be turned OFF <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_cfg_gen">CddDeinitApi</a>   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcDeinit (void)  </td><td>Service for CDD Initialization  </td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x08 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>none </td><td>NA  </td></tr>
<tr>
<td><em><b>Parameters out</b></em> </td><td>none </td><td>NA   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_028  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3688   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_api_Cdd_IpcSendMsg"></a>
Cdd_IpcSendMsg</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcSendMsg </td><td>Service for sending an message to remote cores   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcSendMsg(uint32 chId, void *pBuf, uint32  bufLen)  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x03 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>chId </td><td>chId Refers to communication ID specified while configuring this module, refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">chId</a>  </td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>pBuf </td><td>Non NULL_PTR that describes the message that has to sent   </td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>bufLen </td><td>Message length in bytes   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK on successful transmission, CDD_IPC_E_SEND on error and CDD_IPC_E_UNINIT when initialized   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_029  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3717, MCAL-3718, MCAL-3719, MCAL-3720, MCAL-3721, MCAL-3722, MCAL-3723   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_api_Cdd_IpcReceiveMsg"></a>
Cdd_IpcReceiveMsg</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcReceiveMsg </td><td>Service for reception of N bytes of data from remote cores   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcReceiveMsg(uint32 chId, void *pBuf, uint32  bufLen)  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x04 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>chId </td><td>chId Refers to communication ID specified while configuring this module, refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">chId</a>  </td></tr>
<tr>
<td><em><b>Parameter in out </b></em> </td><td>pBuf </td><td>Non NULL_PTR that can hold the received message. Call shall ensure sufficient memory is available, shall be greater than or equal to maximum size specified in configuration. Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">maxMsgSize</a>   </td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>bufLen </td><td>Message length in bytes   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK on successful reception, CDD_IPC_E_RECEIVE_RETRY on no messages, CDD_IPC_E_UNINIT, when uninitialized.   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_030  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3724, MCAL-3725, MCAL-3726, MCAL-3727, MCAL-3728, MCAL-3729   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_Cdd_IpcAnnounce"></a>
Cdd_IpcAnnounce</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcAnnounce </td><td>Used to broadcast capabilities of this core to all other cores, can be turned OFF <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_cfg_gen">CddIpcAnnounceApi</a>   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcAnnounce(void *pBuf, uint32  chId)  </td><td>Service broadcast of message to all cores for a given commnication channel   </td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x05 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>pBuf </td><td>Non NULL_PTR that describes the message that has to sent   </td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>chId </td><td>A Valid Communication Channel Identifier   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK on successful transmission and CDD_IPC_E_SEND on error and CDD_IPC_E_UNINIT when initialized. Also check <a class="el" href="design_ipc_top.html#design_cdd_ipc_constraints">Constraint</a>   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_031  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3730, MCAL-3731, MCAL-3732, MCAL-3733, MCAL-3734, MCAL-3735   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_api_gver"></a>
Cdd_IpcGetVersionInfo</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcGetVersionInfo </td><td>Can potentially be turned OFF, via configuration parameter <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_cfg_gen">CddVersionInfoApi</a>   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>void Cdd_IpcGetVersionInfo(Std_VersionInfoType  VersionInfoPtr)  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x01 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameters out</b></em> </td><td>VersionInfoPtr </td><td>A pointer of type Std_VersionInfoType, which holds the read back values   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>None  </td><td></td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_032  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3739, MCAL-3740, MCAL-3741   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_api_rb"></a>
Cdd_IpcRegisterReadBack</h3>
<p>As noted from previous implementation, the mailbox configuration registers could potentially be corrupted by other entities (s/w or h/w). One of the recommended detection methods would be to periodically read-back the configuration and confirm configuration is consistent. The service API defined below shall be implemented to enable this detection.</p>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcRegisterReadBack </td><td>Can potentially be turned OFF  </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcRegisterReadBack(Cdd_IpcRegRbValues *RegRbPtr)  </td><td><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_readback_type">Cdd_IpcRegRbValues</a> defines the type, that holds critical values. This service can be turned OFF <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_cfg_gen">CddRegisterReadBackApi</a>  </td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x07 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameters out</b></em> </td><td>RegRbPtr </td><td>A pointer of type <a class="el" href="structCdd__IpcRegRbValues.html">Cdd_IpcRegRbValues</a>, which holds the read back values   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK or E_NOT_OK in case of error  </td></tr>
</table>
<p>The critical register set shall be determined at implementation.</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_033  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3736, MCAL-3737, MCAL-3738   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="design_cdd_ipc_low_level_api_Cdd_IpcReceiveCtrlMsg"></a>
Cdd_IpcReceiveCtrlMsg</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcReceiveCtrlMsg </td><td>Service for reception of N bytes of control data from remote cores   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>Std_ReturnType Cdd_IpcReceiveCtrlMsg(uint32 *pRemoteProcId, uint32 *pRemoteEndPt, void *pBuf, uint32  bufLen)  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x09 </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Non Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in out </b></em> </td><td>pRemoteProcId </td><td>Holds the remote processor identifier, one of valid remote processors specified while initializing, refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_desc_com_chs">RemoteProcID</a>  </td></tr>
<tr>
<td><em><b>Parameter in out </b></em> </td><td>pRemoteEndPt </td><td>Holds the remote processor end point, that is the originator of this control message  </td></tr>
<tr>
<td><em><b>Parameter in out </b></em> </td><td>pBuf </td><td>Non NULL_PTR that can hold the received message. Call shall ensure sufficient memory is available, shall be greater than or equal to maximum size specified in configuration. Refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_Cdd_IpcChannelType">maxMsgSize</a>   </td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>bufLen </td><td>Received message length in bytes   </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Standard return type </td><td>E_OK on successful reception, E_NOT_OK on no messages, CDD_IPC_E_UNINIT, when uninitialized and CDD_IPC_E_PARAM_POINTER when any one of the pointer is NULL   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_039  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-4068, MCAL-4069, MCAL-4070, MCAL-4071, MCAL-4072   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_low_level_api_Cdd_IpcIsInitDone"></a>
Cdd_IpcIsInitDone</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcIsInitDone </td><td>Returns TRUE if Cdd_ipcInit is completed else FALSE   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>boolean <a class="el" href="group__MCAL__IPC__API.html#ga131c00f3f626dce811856da47f363d7c" title="Service for checking if IPC module is initialized.">Cdd_IpcIsInitDone(void)</a>  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x0A </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Reentrant </td><td></td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Boolean </td><td>Returns TRUE if Cdd_IpcInit was completed else FALSE   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_040  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-4452   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="design_cdd_ipc_low_level_api_Cdd_IpcGetMaxMsgSize"></a>
Cdd_IpcGetMaxMsgSize</h3>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Cdd_IpcGetMaxMsgSize </td><td>Returns max msg size for the specified channel   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>uint32 Cdd_IpcGetMaxMsgSize(uint32 chId)  </td><td></td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>0x0B </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Reentrant </td><td></td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>uint32 </td><td>Returns max msg size for the specified channel   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_041  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-4453   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_low_level_api_isr"></a>
Cdd_IpcNewMessageNotify ISR</h2>
<p>The flow chart below depict the behaviour of ISR on reception of mailbox non-empty interrupt</p>
<div class="image">
<img src="cdd_ipc_arch_isr.png" alt="cdd_ipc_arch_isr.png"/>
<div class="caption">
New Message ISR Flow chart &amp; Reception Service API call</div></div>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_034  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3691, MCAL-3701   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_low_level_api">Back To APIs</a></p>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h2><a class="anchor" id="design_cdd_ipc_low_level_globals"></a>
Global Variables</h2>
<p>This design expects that implementation will require to use following global variables.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Description  </th><th class="markdownTableHeadNone">Default Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Cdd_IpcDrvStatus  </td><td class="markdownTableBodyNone">uint32  </td><td class="markdownTableBodyNone">Initialization status of the driver is maintained  </td><td class="markdownTableBodyNone">FALSE   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cdd_IpcDrvObj  </td><td class="markdownTableBodyNone">Cdd_IpcDriverObjType  </td><td class="markdownTableBodyNone">IPC driver object, local to the implementation and scope shall be limited to Cdd_Ipc.c  </td><td class="markdownTableBodyNone">Un defined   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_035  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>MCAL-3706   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="design_cdd_ipc_dar_top"></a>
Decision Analysis &amp; Resolution (DAR)</h1>
<p>Sections below list some of the important design decisions and rational behind those decision.</p>
<h2><a class="anchor" id="design_cdd_ipc_dar_reload"></a>
Allocation of memory for LocalQ</h2>
<p>The memory required to implement queues used to store the received messages could be allocated by user of this module or by this module itself, please refer <a class="el" href="design_ipc_top.html#design_cdd_ipc_rpmsg_id">LocalQ</a> for need of local queue</p>
<h2><a class="anchor" id="design_cdd_ipc_dar_criteria"></a>
DAR Criteria</h2>
<p>Simpler interface and minimize potential errors</p>
<h2><a class="anchor" id="design_cdd_ipc_dar_alternatives"></a>
Available Alternatives</h2>
<ul>
<li><b> Allocated by user of this module </b> The user / integrator allocates the required memory and provides a pointer to the allocated memory while configuring this driver<ul>
<li><b> Advantages: </b><ul>
<li>Complete control for the integrators, size and location of the allocated memory</li>
</ul>
</li>
<li><b> Disadvantages: </b><ul>
<li>Additional configuration parameter</li>
<li>Location specified via a global memory</li>
<li>Additional checks in the driver required for alignment and null pointer checks</li>
</ul>
</li>
</ul>
</li>
<li><b> Local Allocation </b> Driver allocates the memory statically, i.e. via an array.<ul>
<li><b> Advantages: </b><ul>
<li>Minimal configuration parameters</li>
<li>Alignment can be easily enforced</li>
</ul>
</li>
<li><b> Disadvantages: </b><ul>
<li>The size of memory is computed and integrator will have to analyze the system memory requirement post compilation of the driver</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="design_cdd_ipc_dar_decision"></a>
Decision</h2>
<p>To minimize the checks and enhanced ease-of-use, <b>Local Allocation</b> is chosen.</p>
<table class="doxtable">
<tr>
<td><em><b>Design ID</b></em> </td><td>DES_CDD_IPC_036  </td></tr>
<tr>
<td><em><b>Requirements Covered</b></em> </td><td>None   </td></tr>
</table>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="design_cdd_ipc_test_top"></a>
Test Criteria</h1>
<p>The sections below identify some of the aspects of design that would require emphasis during testing of this design implementation</p>
<ul>
<li><b> Boundary Checks </b><ul>
<li>Since variable length messages could be transmitted, tests on message size range shall be performed.</li>
<li>Ensure associated error codes are returned on error</li>
</ul>
</li>
<li><b> Latency Measurements </b><ul>
<li>Test cases shall ensure, latencies are measured for transmission and reception</li>
</ul>
</li>
<li><b> Concurrency </b><ul>
<li>Since a core can communicate with multiple cores on different channels, data integrity checks shall be performed when communicating with multiple cores on multiple channels, concurrently.</li>
</ul>
</li>
</ul>
<p><a class="el" href="design_ipc_top.html#design_cdd_ipc_intro">Back To Top</a></p>
<hr/>
<h1><a class="anchor" id="design_cdd_ipc_rev_hist"></a>
Document Revision History</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Revision  </th><th class="markdownTableHeadNone">Date  </th><th class="markdownTableHeadNone">Author  </th><th class="markdownTableHeadNone">Description  </th><th class="markdownTableHeadNone">Status   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.1  </td><td class="markdownTableBodyNone">11 March 2019  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">First version  </td><td class="markdownTableBodyNone">Pending Review   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.2  </td><td class="markdownTableBodyNone">22 March 2019  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Addressed review comments  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.3  </td><td class="markdownTableBodyNone">01 October 2019  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Updated to include control-end point and associated API's  </td><td class="markdownTableBodyNone">Pending Review   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.4  </td><td class="markdownTableBodyNone">20 January 2020  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Updated Cdd_IpcAnnounce () API to take communication channel ID (Fix for MCAL-4428)  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.5  </td><td class="markdownTableBodyNone">10 February 2020  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Added support for Cdd_IpcGetMaxMsgSize API and Cdd_IpcIsInitDone  </td><td class="markdownTableBodyNone">Approved   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="design_top.html">MCAL Module Design</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
